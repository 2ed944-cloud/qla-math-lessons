<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>G7 â€¢ Comparing & Simplifying Rational Numbers â€” QLA Enhanced</title>

<!-- Fonts & Tailwind -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>

<!-- KaTeX -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" crossorigin="anonymous"></script>

<style>
  :root{--maroon:#6C1D45;--gold:#C7A34F;--dark:#1a1a1a;--light:#F5F5F5;--accent:#E8D5B7;--qatar-red:#8D1B3D;--success:#16a34a;--warning:#ea580c;--error:#dc2626}
  *{margin:0;padding:0;box-sizing:border-box}
  html,body{height:100%;background:#0f172a;color:#1a1a1a;font-family:Inter,system-ui,sans-serif;font-size:18px}
  
  #deck{position:relative;width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;padding:10px}
  #slides{position:relative;width:100%;max-width:1400px;aspect-ratio:16/9;background:#fff;box-shadow:0 20px 50px rgba(0,0,0,.4);overflow:hidden;border-radius:20px}

  .slide{position:absolute;inset:0;padding:3%;display:flex;flex-direction:column;opacity:0;transform:translateY(20px) scale(.97);transition:.6s cubic-bezier(.4,0,.2,1);pointer-events:none;overflow-y:auto;font-size:1.1rem}
  .slide.active{opacity:1;transform:none;pointer-events:auto}

  .bg-maroon{background:linear-gradient(135deg, var(--maroon) 0%, var(--qatar-red) 100%)}
  .text-maroon{color:var(--maroon)}
  .text-gold{color:var(--gold)}
  
  .banner{width:100%;height:120px;background:#fff center/contain no-repeat;border-bottom:4px solid var(--gold);border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.1)}
  .logo{height:100px;width:auto;object-fit:contain}

  .card{border:2px solid #cbd5e1;border-radius:16px;background:#ffffff;transition:.3s;box-shadow:0 2px 8px rgba(0,0,0,.06)}
  .card:hover{border-color:var(--gold);box-shadow:0 6px 16px rgba(0,0,0,.12)}
  
  .chip{display:inline-flex;align-items:center;gap:.4rem;background:#ffffff;border:2px solid var(--maroon);border-radius:999px;padding:.5rem 1rem;cursor:pointer;transition:.2s;font-size:1rem;font-weight:600;color:var(--maroon)}
  .chip:hover{background:var(--maroon);color:#fff;transform:translateY(-2px);box-shadow:0 6px 12px rgba(108,29,69,.25)}
  
  .btn{padding:.7rem 1.4rem;border-radius:999px;border:2px solid #94a3b8;background:#fff;font-weight:700;cursor:pointer;transition:.2s;font-size:1.05rem;color:var(--dark)}
  .btn:hover{transform:translateY(-2px);box-shadow:0 6px 12px rgba(0,0,0,.15);border-color:var(--maroon)}
  .btn.maroon{background:var(--maroon);color:#fff;border-color:var(--maroon)}
  .btn.maroon:hover{background:#5a1739}
  .btn.gold{background:var(--gold);color:var(--dark);border-color:var(--gold);font-weight:800}
  .btn.gold:hover{background:#b8943d}
  .btn:disabled{opacity:.5;cursor:not-allowed}

  .badge{display:inline-flex;align-items:center;gap:.4rem;padding:.45rem .85rem;border-radius:999px;font-size:.95rem;font-weight:700}
  .badge.beginner{background:#dbeafe;color:#1e40af;border:2px solid #3b82f6}
  .badge.intermediate{background:#fef3c7;color:#92400e;border:2px solid #f59e0b}
  .badge.advanced{background:#fecaca;color:#991b1b;border:2px solid #ef4444}
  .badge.mastered{background:#d1fae5;color:#065f46;border:2px solid #16a34a}

  #controls{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);display:flex;align-items:center;gap:.8rem;background:rgba(0,0,0,.85);padding:.6rem 1rem;border-radius:999px;z-index:100;backdrop-filter:blur(10px);border:2px solid rgba(255,255,255,.1)}
  #controls button{width:48px;height:48px;border-radius:999px;border:none;background:#fff;cursor:pointer;font-weight:800;transition:.2s;font-size:1.3rem;color:var(--dark)}
  #controls button:hover{transform:scale(1.15);box-shadow:0 6px 16px rgba(255,255,255,.4)}
  #counter{color:#fff;font-weight:800;min-width:100px;text-align:center;font-size:1.1rem}
  
  #progress{position:fixed;left:0;top:0;height:8px;width:0;background:linear-gradient(90deg, var(--gold), var(--maroon));z-index:101;transition:width .4s ease;box-shadow:0 4px 12px rgba(199,163,79,.6)}
  
  #teacherNotes{position:fixed;right:20px;top:80px;background:rgba(26,26,26,.95);color:#fff;padding:1.2rem;border-radius:12px;max-width:340px;z-index:99;backdrop-filter:blur(10px);display:none;border:2px solid var(--gold);font-size:1rem;line-height:1.6}
  #teacherNotes.show{display:block}
  #teacherToggle{position:fixed;right:20px;top:20px;z-index:100;background:var(--maroon);color:#fff;border:none;padding:.7rem 1.2rem;border-radius:10px;cursor:pointer;font-weight:700;font-size:.95rem;border:2px solid var(--gold);box-shadow:0 4px 12px rgba(0,0,0,.2)}
  #teacherToggle:hover{background:#5a1739;transform:translateY(-2px)}

  #studentProgress{position:fixed;left:20px;top:20px;background:#ffffff;padding:1.2rem;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,.2);z-index:99;max-width:300px;border:2px solid var(--gold)}
  #studentProgress .progress-bar{height:10px;background:#e2e8f0;border-radius:999px;overflow:hidden;margin:.6rem 0;border:1px solid #cbd5e1}
  #studentProgress .progress-fill{height:100%;background:linear-gradient(90deg, var(--success), var(--gold));transition:width .5s}

  .hint{background:#fffbeb;border:2px solid #fbbf24;border-radius:12px;padding:1rem 1.2rem;border-left:5px solid var(--warning);font-size:1.05rem;color:var(--dark)}
  .success-msg{background:#f0fdf4;border:2px solid #86efac;border-radius:12px;padding:1rem 1.2rem;border-left:5px solid var(--success);font-size:1.05rem;color:var(--dark)}
  .error-msg{background:#fef2f2;border:2px solid #fca5a5;border-radius:12px;padding:1rem 1.2rem;border-left:5px solid var(--error);font-size:1.05rem;color:var(--dark)}

  .confetti{position:fixed;pointer-events:none;z-index:200;font-size:2rem}

  .sortable{list-style:none;padding:0;margin:0}
  .sortable li{user-select:none;background:#fff;border:3px solid #cbd5e1;border-radius:12px;margin:.6rem 0;padding:1rem 1.2rem;cursor:grab;transition:.2s;display:flex;align-items:center;gap:.8rem;font-size:1.15rem;font-weight:600}
  .sortable li:hover{border-color:var(--gold);transform:translateX(6px);background:#fefce8}
  .sortable .dragging{opacity:.6;transform:scale(.98);cursor:grabbing}
  .handle{font-size:1.5rem;color:#64748b;cursor:grab;font-weight:800}

  input[type="text"], input[type="number"], select, textarea{border:2px solid #cbd5e1;border-radius:10px;padding:.7rem 1rem;font-size:1.05rem;transition:.2s;font-family:inherit;background:#fff;color:var(--dark)}
  input:focus, select:focus, textarea:focus{outline:none;border-color:var(--maroon);box-shadow:0 0 0 4px rgba(108,29,69,.15)}
  input.correct{border-color:var(--success);background:#f0fdf4;border-width:3px}
  input.incorrect{border-color:var(--error);background:#fef2f2;border-width:3px}

  .qatar-context{background:linear-gradient(135deg, #f0fdf4 0%, #dbeafe 100%);border:3px solid var(--gold);border-radius:12px;padding:1.5rem;margin:1rem 0;box-shadow:0 4px 12px rgba(0,0,0,.08)}
  .qatar-icon{font-size:2rem;margin-right:.5rem}

  .differentiation-tabs{display:flex;gap:.6rem;margin:1.2rem 0;flex-wrap:wrap}
  .diff-tab{padding:.8rem 1.4rem;border-radius:10px 10px 0 0;border:3px solid #cbd5e1;background:#f8fafc;cursor:pointer;font-weight:700;transition:.2s;font-size:1.05rem;color:var(--dark)}
  .diff-tab.active{background:#fff;border-bottom-color:#fff;color:var(--maroon);border-color:var(--maroon)}
  .diff-tab:hover{background:#fff}

  .mastery-level{display:flex;gap:1rem;align-items:center;margin:1.5rem 0;flex-wrap:wrap}
  .mastery-level .level{flex:1;text-align:center;padding:1rem;border-radius:10px;border:3px solid #cbd5e1;transition:.3s;min-width:180px;background:#fff;cursor:pointer}
  .mastery-level .level:hover{border-color:var(--gold);transform:translateY(-4px);box-shadow:0 6px 16px rgba(0,0,0,.1)}
  .mastery-level .level.active{border-color:var(--maroon);background:rgba(108,29,69,.05);transform:scale(1.05);box-shadow:0 8px 20px rgba(108,29,69,.15)}
  .mastery-level .level.complete{background:var(--success);color:#fff;border-color:var(--success)}

  @keyframes celebrate{0%{transform:scale(1) rotate(0deg)}50%{transform:scale(1.2) rotate(180deg)}100%{transform:scale(1) rotate(360deg)}}
  .celebrating{animation:celebrate .6s ease-in-out}

  .peer-check{background:#eff6ff;border:3px dashed #3b82f6;border-radius:12px;padding:1.2rem;margin:1rem 0;font-size:1.05rem}
  
  @media(max-width:768px){
    #slides{aspect-ratio:4/3}
    .slide{padding:2%;font-size:1rem}
    #studentProgress, #teacherNotes{position:static;margin:1rem}
    h1{font-size:2rem !important}
    h2{font-size:1.8rem !important}
    h3{font-size:1.4rem !important}
  }
</style>
</head>
<body>

<button id="teacherToggle">ğŸ‘¨â€ğŸ« Teacher Notes</button>
<div id="teacherNotes"></div>

<div id="studentProgress">
  <div style="font-weight:800;color:var(--maroon);margin-bottom:.8rem;font-size:1.15rem">ğŸ“Š Your Progress</div>
  <div class="progress-bar"><div class="progress-fill" id="masterBar" style="width:0%"></div></div>
  <div style="font-size:1.05rem;color:#334155;margin-top:.5rem;font-weight:700">
    <span id="masterPercent">0</span>% Complete
  </div>
  <div style="margin-top:1rem;font-size:1.05rem;color:var(--dark);line-height:1.8;font-weight:600">
    <div>âœ… <span id="completeCount">0</span> activities mastered</div>
    <div>â­ Streak: <span id="streakDisplay" style="color:var(--gold);font-weight:800">0</span></div>
  </div>
</div>

<div id="deck" aria-live="polite">
  <div id="slides" class="relative">

    <!-- 0 â€¢ Title & Welcome -->
    <section class="slide active bg-maroon text-white" id="titleSlide">
      <!-- QLA Banner at top -->
      <div class="banner" style="background-image:url('qla_banner.png');margin-bottom:1.5rem" aria-label="QLA Banner">
        <!-- Fallback if image doesn't load -->
        <div style="display:flex;align-items:center;justify-content:center;height:100%;font-weight:800;font-size:1.5rem;color:var(--maroon)">
          QATAR LEADERSHIP ACADEMY
        </div>
      </div>
      
      <div style="display:flex;align-items:center;justify-content:center;gap:2rem;margin:1.5rem 0">
        <!-- Logo -->
        <img src="qla_logo.png" alt="QLA Logo" class="logo" style="filter:drop-shadow(0 4px 12px rgba(0,0,0,.3))" onerror="this.style.display='none'"/>
        
        <div style="text-align:left">
          <h1 style="font-size:4rem;font-weight:900;margin-bottom:1rem;text-shadow:3px 3px 6px rgba(0,0,0,.4);line-height:1.2">
           
          </h1>
          <h2 style="font-size:3rem;font-weight:800;margin-bottom:.5rem;text-shadow:2px 2px 4px rgba(0,0,0,.3)">
            Comparing & Simplifying<br>Rational Numbers
          </h2>
          <p class="text-gold" style="font-size:1.8rem;font-weight:700;margin-top:1rem;text-shadow:1px 1px 3px rgba(0,0,0,.3)">
            ğŸ“Š Fractions â€¢ ğŸ’¯ Decimals â€¢ ğŸ”¢ Mixed Numbers
          </p>
        </div>
      </div>
      
      <div style="font-size:1.4rem;margin:1.5rem 0;font-weight:600;text-shadow:1px 1px 3px rgba(0,0,0,.3)">
        ğŸ›ï¸ Qatar Leadership Academy â€” Grade 7 Mathematics
      </div>
      
      <div style="background:rgba(255,255,255,.2);backdrop-filter:blur(10px);border-radius:16px;padding:2rem;max-width:900px;margin:1rem auto;border:3px solid rgba(199,163,79,.5);box-shadow:0 8px 24px rgba(0,0,0,.2)">
        <div style="font-size:1.4rem;margin-bottom:1.5rem;font-weight:800;text-shadow:1px 1px 2px rgba(0,0,0,.2)">
          ğŸ¯ Today's Mastery Journey
        </div>
        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:1.5rem;text-align:center">
          <div style="background:rgba(255,255,255,.15);padding:1.2rem;border-radius:12px;backdrop-filter:blur(5px)">
            <div style="font-size:2.5rem;margin-bottom:.5rem">ğŸ“Š</div>
            <div style="font-size:1.15rem;font-weight:700">Explore</div>
          </div>
          <div style="background:rgba(255,255,255,.15);padding:1.2rem;border-radius:12px;backdrop-filter:blur(5px)">
            <div style="font-size:2.5rem;margin-bottom:.5rem">ğŸ“</div>
            <div style="font-size:1.15rem;font-weight:700">Practice</div>
          </div>
          <div style="background:rgba(255,255,255,.15);padding:1.2rem;border-radius:12px;backdrop-filter:blur(5px)">
            <div style="font-size:2.5rem;margin-bottom:.5rem">ğŸŒ</div>
            <div style="font-size:1.15rem;font-weight:700">Apply</div>
          </div>
          <div style="background:rgba(255,255,255,.15);padding:1.2rem;border-radius:12px;backdrop-filter:blur(5px)">
            <div style="font-size:2.5rem;margin-bottom:.5rem">ğŸ†</div>
            <div style="font-size:1.15rem;font-weight:700">Master</div>
          </div>
        </div>
      </div>
      
      <div style="position:absolute;bottom:1.5rem;left:50%;transform:translateX(-50%);font-size:1.05rem;opacity:.95;text-shadow:1px 1px 2px rgba(0,0,0,.3);font-weight:600">
        ğŸ“š Aligned to AERO 7.NS.1 & 7.NS.2 | Student-Centered Mastery Learning
      </div>
    </section>

    <!-- 1 â€¢ Learning Goals & Success Criteria (Student-Centered) -->
    <section class="slide" id="goalsSlide">
      <h2 style="font-size:3rem;font-weight:900;color:var(--maroon);margin-bottom:1.5rem;text-align:center">
        ğŸ“š What Will You Master Today?
      </h2>
      
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:2rem;max-width:1200px;margin:0 auto">
        <div class="card" style="padding:2rem">
          <h3 style="font-size:1.8rem;font-weight:800;color:var(--maroon);margin-bottom:1.2rem">
            ğŸ¯ I Can Statements
          </h3>
          <div style="space-y:1rem">
            <div style="display:flex;gap:1rem;margin-bottom:1.2rem;align-items:start">
              <input type="checkbox" id="goal1" style="width:24px;height:24px;cursor:pointer;margin-top:2px">
              <label for="goal1" style="cursor:pointer;font-size:1.1rem;line-height:1.5">I can <strong style="color:var(--maroon)">simplify fractions</strong> to their simplest form using GCF</label>
            </div>
            <div style="display:flex;gap:1rem;margin-bottom:1.2rem;align-items:start">
              <input type="checkbox" id="goal2" style="width:24px;height:24px;cursor:pointer;margin-top:2px">
              <label for="goal2" style="cursor:pointer;font-size:1.1rem;line-height:1.5">I can <strong style="color:var(--maroon)">compare rational numbers</strong> using 3 different methods</label>
            </div>
            <div style="display:flex;gap:1rem;margin-bottom:1.2rem;align-items:start">
              <input type="checkbox" id="goal3" style="width:24px;height:24px;cursor:pointer;margin-top:2px">
              <label for="goal3" style="cursor:pointer;font-size:1.1rem;line-height:1.5">I can <strong style="color:var(--maroon)">order fractions</strong> from least to greatest and explain why</label>
            </div>
            <div style="display:flex;gap:1rem;margin-bottom:1.2rem;align-items:start">
              <input type="checkbox" id="goal4" style="width:24px;height:24px;cursor:pointer;margin-top:2px">
              <label for="goal4" style="cursor:pointer;font-size:1.1rem;line-height:1.5">I can <strong style="color:var(--maroon)">apply rational numbers</strong> to solve Qatar real-world problems</label>
            </div>
          </div>
        </div>

        <div class="card" style="padding:2rem">
          <h3 style="font-size:1.8rem;font-weight:800;color:var(--maroon);margin-bottom:1.2rem">
            ğŸ”‘ Key Vocabulary (Tap to Learn)
          </h3>
          <div style="display:flex;flex-wrap:wrap;gap:.8rem">
            <span class="chip" data-key="rat">rational number (Ø¹Ø¯Ø¯ Ù†Ø³Ø¨ÙŠ)</span>
            <span class="chip" data-key="eqv">equivalent fractions (ÙƒØ³ÙˆØ± Ù…ØªØ³Ø§ÙˆÙŠØ©)</span>
            <span class="chip" data-key="simp">simplest form (Ø£Ø¨Ø³Ø· ØµÙˆØ±Ø©)</span>
            <span class="chip" data-key="gcf">GCF (Ø¹.Ù….Ø£)</span>
            <span class="chip" data-key="lcd">LCD (Ù….Ù….Ø£)</span>
            <span class="chip" data-key="cross">cross-multiplication</span>
            <span class="chip" data-key="mixed">mixed number (Ø¹Ø¯Ø¯ ÙƒØ³Ø±ÙŠ)</span>
            <span class="chip" data-key="qar">QAR (Qatari Riyal)</span>
          </div>
          <div class="hint" style="margin-top:1.2rem;font-size:1.05rem">
            ğŸ’¡ <strong>Learning Tip:</strong> You'll use these concepts to solve problems about Qatar's economy, sports, and daily life!
          </div>
        </div>
      </div>

      <div class="mastery-level" style="margin-top:2rem;max-width:1100px;margin-left:auto;margin-right:auto">
        <div class="level" data-level="1">
          <div style="font-size:2.5rem;margin-bottom:.5rem">ğŸŒ±</div>
          <div style="font-weight:800;font-size:1.15rem;margin-bottom:.3rem">Level 1: Explore</div>
          <div style="font-size:1rem;color:#475569">Understand concepts</div>
        </div>
        <div class="level" data-level="2">
          <div style="font-size:2.5rem;margin-bottom:.5rem">ğŸŒ¿</div>
          <div style="font-weight:800;font-size:1.15rem;margin-bottom:.3rem">Level 2: Practice</div>
          <div style="font-size:1rem;color:#475569">Build skills</div>
        </div>
        <div class="level" data-level="3">
          <div style="font-size:2.5rem;margin-bottom:.5rem">ğŸŒ³</div>
          <div style="font-weight:800;font-size:1.15rem;margin-bottom:.3rem">Level 3: Apply</div>
          <div style="font-size:1rem;color:#475569">Real-world problems</div>
        </div>
        <div class="level" data-level="4">
          <div style="font-size:2.5rem;margin-bottom:.5rem">ğŸ†</div>
          <div style="font-weight:800;font-size:1.15rem;margin-bottom:.3rem">Level 4: Master</div>
          <div style="font-size:1rem;color:#475569">Teach others</div>
        </div>
      </div>
    </section>

    <!-- 2 â€¢ Think-Pair-Share Warm-Up (Qatar Context) -->
    <section class="slide" id="warmupSlide">
      <h2 style="font-size:3rem;font-weight:900;color:var(--maroon);margin-bottom:1.2rem;text-align:center">
        ğŸ¤” Think â€¢ ğŸ‘¥ Pair â€¢ ğŸ’¬ Share
      </h2>
      
      <div class="qatar-context" style="max-width:950px;margin:1rem auto">
        <div style="font-size:1.6rem;font-weight:800;margin-bottom:1.2rem;color:var(--maroon)">
          ğŸŸï¸ Scenario: Khalifa International Stadium Seating
        </div>
        <div style="font-size:1.2rem;line-height:1.8;margin-bottom:1.5rem;color:var(--dark)">
          During a Qatar Stars League match:
          <ul style="margin-left:2.5rem;margin-top:.8rem;font-weight:600">
            <li style="margin-bottom:.5rem">Section A is <strong style="color:var(--maroon)">\\(\\frac{3}{4}\\)</strong> full</li>
            <li style="margin-bottom:.5rem">Section B is <strong style="color:var(--maroon)">\\(\\frac{7}{10}\\)</strong> full</li>
            <li style="margin-bottom:.5rem">Section C is <strong style="color:var(--maroon)">0.72</strong> full</li>
          </ul>
        </div>
        <div style="background:#fff;border-radius:12px;padding:1.5rem;margin:1.5rem 0;border:3px solid var(--maroon)">
          <div style="font-weight:800;margin-bottom:.8rem;font-size:1.25rem;color:var(--maroon)">ğŸ¤” THINK (2 minutes)</div>
          <div style="font-size:1.1rem;margin-bottom:.8rem;color:var(--dark)">Which section has the most fans? How can you tell without converting to decimals?</div>
          <textarea id="thinkBox" style="width:100%;margin-top:.8rem;padding:.8rem;border-radius:8px;border:3px solid #cbd5e1;min-height:80px;font-size:1.05rem" placeholder="Write your thinking here..."></textarea>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.2rem">
          <div style="background:#fff;border-radius:12px;padding:1.5rem;border:3px solid #3b82f6">
            <div style="font-weight:800;margin-bottom:.6rem;font-size:1.25rem;color:#1e40af">ğŸ‘¥ PAIR (3 minutes)</div>
            <div style="font-size:1.05rem;color:var(--dark);line-height:1.6">Discuss with your partner. What strategies did you each use?</div>
          </div>
          <div style="background:#fff;border-radius:12px;padding:1.5rem;border:3px solid var(--success)">
            <div style="font-weight:800;margin-bottom:.6rem;font-size:1.25rem;color:#065f46">ğŸ’¬ SHARE (3 minutes)</div>
            <div style="font-size:1.05rem;color:var(--dark);line-height:1.6">Share your group's best strategy with the class.</div>
          </div>
        </div>
      </div>

      <div style="text-align:center;margin-top:1.5rem">
        <button class="btn maroon" onclick="showAnswer()" style="font-size:1.2rem;padding:.9rem 2rem">ğŸ” Reveal Answer & Strategies</button>
        <div id="warmupAnswer" style="display:none;margin-top:1.2rem;max-width:850px;margin-left:auto;margin-right:auto"></div>
      </div>
    </section>

    <!-- 3 â€¢ Guided Learning: Simplifying (Differentiated) -->
    <section class="slide" id="simplifyLearnSlide">
      <h2 style="font-size:2.5rem;font-weight:800;color:var(--maroon);margin-bottom:1rem;text-align:center">
        ğŸ“ Simplifying Fractions: Your Way
      </h2>

      <div class="differentiation-tabs">
        <div class="diff-tab active" data-diff="visual">ğŸ¨ Visual Learner</div>
        <div class="diff-tab" data-diff="steps">ğŸ“ Step-by-Step</div>
        <div class="diff-tab" data-diff="practice">âœï¸ Try It Now</div>
      </div>

      <div class="diff-content active" id="diff-visual">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;max-width:1100px;margin:0 auto">
          <div class="card" style="padding:1.5rem">
            <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">ğŸ–¼ï¸ Visual Model</h3>
            <div style="text-align:center">
              <div style="font-size:1.2rem;margin-bottom:1rem">Simplifying \(\frac{12}{18}\)</div>
              <div style="display:grid;grid-template-columns:repeat(6,1fr);gap:4px;margin-bottom:1rem">
                <div style="aspect-ratio:1;background:#ef4444;border-radius:4px"></div>
                <div style="aspect-ratio:1;background:#ef4444;border-radius:4px"></div>
                <div style="aspect-ratio:1;background:#3b82f6;border-radius:4px"></div>
                <div style="aspect-ratio:1;background:#3b82f6;border-radius:4px"></div>
                <div style="aspect-ratio:1;background:#22c55e;border-radius:4px"></div>
                <div style="aspect-ratio:1;background:#22c55e;border-radius:4px"></div>
              </div>
              <div style="font-size:.95rem;color:#666;margin:1rem 0">
                12 shaded out of 18 total = 6 groups of 2 out of 9 groups of 2
              </div>
              <div style="font-size:1.3rem;font-weight:700;color:var(--success)">
                \(\frac{12}{18} = \frac{12 \div 6}{18 \div 6} = \frac{2}{3}\)
              </div>
            </div>
          </div>

          <div class="card" style="padding:1.5rem">
            <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">ğŸ”¢ Factor Tree Method</h3>
            <div id="factorViz" style="font-size:1.1rem;line-height:1.8">
              <div><strong>12</strong> = 2 Ã— 2 Ã— 3</div>
              <div><strong>18</strong> = 2 Ã— 3 Ã— 3</div>
              <div style="margin:1rem 0;padding:1rem;background:#fffbeb;border-radius:8px">
                <strong>Common factors:</strong> 2 Ã— 3 = 6<br>
                <strong>GCF = 6</strong>
              </div>
              <div style="font-size:1.2rem;font-weight:700;color:var(--maroon)">
                \(\frac{12 \div 6}{18 \div 6} = \frac{2}{3}\)
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="diff-content" id="diff-steps" style="display:none">
        <div class="card" style="padding:2rem;max-width:900px;margin:0 auto">
          <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1.5rem;font-size:1.3rem">
            ğŸ“‹ Step-by-Step Process
          </h3>
          <div style="display:grid;gap:1rem">
            <div style="display:flex;gap:1rem;padding:1rem;background:#f0fdf4;border-radius:8px;border-left:4px solid var(--success)">
              <div style="font-size:1.5rem;font-weight:700;color:var(--success);min-width:2rem">1</div>
              <div>
                <div style="font-weight:700;margin-bottom:.3rem">Find the GCF</div>
                <div>List factors or use prime factorization to find the Greatest Common Factor</div>
              </div>
            </div>
            <div style="display:flex;gap:1rem;padding:1rem;background:#dbeafe;border-radius:8px;border-left:4px solid #3b82f6">
              <div style="font-size:1.5rem;font-weight:700;color:#3b82f6;min-width:2rem">2</div>
              <div>
                <div style="font-weight:700;margin-bottom:.3rem">Divide Both Parts</div>
                <div>Divide numerator AND denominator by the GCF</div>
              </div>
            </div>
            <div style="display:flex;gap:1rem;padding:1rem;background:#fef3c7;border-radius:8px;border-left:4px solid var(--warning)">
              <div style="font-size:1.5rem;font-weight:700;color:var(--warning);min-width:2rem">3</div>
              <div>
                <div style="font-weight:700;margin-bottom:.3rem">Check Your Answer</div>
                <div>The numerator and denominator should have no common factors except 1</div>
              </div>
            </div>
          </div>
          <div class="hint" style="margin-top:1.5rem">
            <strong>ğŸ’¡ Pro Tip:</strong> You can simplify in multiple steps! Divide by 2, then 3, then 2 again - it all works!
          </div>
        </div>
      </div>

      <div class="diff-content" id="diff-practice" style="display:none">
        <div class="card" style="padding:2rem;max-width:900px;margin:0 auto">
          <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">âœï¸ Your Turn: Interactive Practice</h3>
          <div id="simplifyPractice"></div>
        </div>
      </div>
    </section>

    <!-- 4 â€¢ Comparing Methods (Student Discovery) -->
    <section class="slide" id="compareMethodsSlide">
      <h2 style="font-size:2.5rem;font-weight:800;color:var(--maroon);margin-bottom:1rem;text-align:center">
        âš–ï¸ Three Ways to Compare - You Choose!
      </h2>

      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:1.5rem;max-width:1200px;margin:0 auto">
        <div class="card" style="padding:1.5rem;cursor:pointer;transition:.3s" onclick="showMethod('lcd')">
          <div style="text-align:center">
            <div style="font-size:3rem;margin-bottom:.5rem">1ï¸âƒ£</div>
            <h3 style="font-weight:700;color:var(--maroon);margin-bottom:.8rem">Common Denominator</h3>
            <div style="font-size:.95rem;line-height:1.6;color:#666">
              Make denominators the same, then compare numerators
            </div>
            <div style="margin-top:1rem;padding:1rem;background:#f9fafb;border-radius:8px">
              <div style="font-size:.9rem">\(\frac{3}{4}\) vs \(\frac{5}{6}\)</div>
              <div style="font-size:.9rem;margin-top:.5rem">\(\frac{9}{12}\) vs \(\frac{10}{12}\)</div>
            </div>
            <button class="btn maroon" style="margin-top:1rem">Explore This Method</button>
          </div>
        </div>

        <div class="card" style="padding:1.5rem;cursor:pointer;transition:.3s" onclick="showMethod('cross')">
          <div style="text-align:center">
            <div style="font-size:3rem;margin-bottom:.5rem">2ï¸âƒ£</div>
            <h3 style="font-weight:700;color:var(--maroon);margin-bottom:.8rem">Cross-Multiplication</h3>
            <div style="font-size:.95rem;line-height:1.6;color:#666">
              Compare products: \(a \times d\) vs \(b \times c\)
            </div>
            <div style="margin-top:1rem;padding:1rem;background:#f9fafb;border-radius:8px">
              <div style="font-size:.9rem">\(\frac{3}{4}\) vs \(\frac{5}{6}\)</div>
              <div style="font-size:.9rem;margin-top:.5rem">3Ã—6=18 vs 4Ã—5=20</div>
            </div>
            <button class="btn maroon" style="margin-top:1rem">Explore This Method</button>
          </div>
        </div>

        <div class="card" style="padding:1.5rem;cursor:pointer;transition:.3s" onclick="showMethod('decimal')">
          <div style="text-align:center">
            <div style="font-size:3rem;margin-bottom:.5rem">3ï¸âƒ£</div>
            <h3 style="font-weight:700;color:var(--maroon);margin-bottom:.8rem">Convert to Decimals</h3>
            <div style="font-size:.95rem;line-height:1.6;color:#666">
              Divide and compare decimal values
            </div>
            <div style="margin-top:1rem;padding:1rem;background:#f9fafb;border-radius:8px">
              <div style="font-size:.9rem">\(\frac{3}{4}\) vs \(\frac{5}{6}\)</div>
              <div style="font-size:.9rem;margin-top:.5rem">0.75 vs 0.833...</div>
            </div>
            <button class="btn maroon" style="margin-top:1rem">Explore This Method</button>
          </div>
        </div>
      </div>

      <div id="methodDetail" style="display:none;margin-top:2rem;max-width:1000px;margin-left:auto;margin-right:auto"></div>

      <div class="peer-check" style="margin-top:1.5rem;max-width:900px;margin-left:auto;margin-right:auto">
        <div style="font-weight:700;margin-bottom:.5rem">ğŸ‘¥ Peer Discussion Prompt:</div>
        <div>Which method do YOU prefer? Why? When would each method be most useful?</div>
        <div style="margin-top:.5rem;font-size:.9rem;color:#666">
          Share with your partner: Explain your favorite method as if teaching a younger student.
        </div>
      </div>
    </section>

    <!-- 5 â€¢ Qatar Real-World Problems (Scaffolded) -->
    <section class="slide" id="qatarProblemsSlide">
      <h2 style="font-size:2.5rem;font-weight:800;color:var(--maroon);margin-bottom:1rem;text-align:center">
        ğŸŒ Math in Qatar: Real-World Applications
      </h2>

      <div style="text-align:center;margin-bottom:1.5rem">
        <div class="badge beginner" style="font-size:1rem">Select Your Level</div>
        <div style="margin-top:.8rem;display:flex;gap:.8rem;justify-content:center">
          <button class="btn level-btn active" data-level="beginner">ğŸŒ± Beginner</button>
          <button class="btn level-btn" data-level="intermediate">ğŸŒ¿ Intermediate</button>
          <button class="btn level-btn" data-level="advanced">ğŸŒ³ Advanced</button>
        </div>
      </div>

      <div id="qatar-beginner" class="qatar-level-content">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;max-width:1200px;margin:0 auto">
          <div class="card" style="padding:1.5rem">
            <div class="qatar-icon">ğŸ›ï¸</div>
            <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">Souq Waqif Shopping</h3>
            <div style="font-size:1.05rem;line-height:1.6;margin-bottom:1rem">
              You have 100 QAR to spend. You spend:
              <ul style="margin-left:1.5rem;margin-top:.5rem">
                <li>\(\frac{2}{5}\) on traditional clothes</li>
                <li>\(\frac{3}{10}\) on spices</li>
              </ul>
              <strong>Which cost more?</strong>
            </div>
            <div style="background:#f9fafb;padding:1rem;border-radius:8px;margin-bottom:1rem">
              <div style="font-weight:600;margin-bottom:.5rem">Scaffold:</div>
              <div style="font-size:.9rem">
                Hint: Make both fractions have denominator 10
              </div>
              <input type="text" id="qatar1" placeholder="clothes or spices?" style="width:100%;margin-top:.5rem">
            </div>
            <button class="btn maroon" onclick="checkQatar(1)">Check Answer</button>
            <div id="feedback1" style="margin-top:.5rem"></div>
          </div>

          <div class="card" style="padding:1.5rem">
            <div class="qatar-icon">âš½</div>
            <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">Aspire Zone Training</h3>
            <div style="font-size:1.05rem;line-height:1.6;margin-bottom:1rem">
              Ahmed runs \(\frac{3}{4}\) of the track.<br>
              Sara runs \(\frac{5}{6}\) of the track.<br>
              <strong>Who ran farther?</strong>
            </div>
            <div style="background:#f9fafb;padding:1rem;border-radius:8px;margin-bottom:1rem">
              <div style="font-weight:600;margin-bottom:.5rem">Scaffold:</div>
              <div style="font-size:.9rem">
                Try: \(\frac{3}{4} = \frac{?}{12}\) and \(\frac{5}{6} = \frac{?}{12}\)
              </div>
              <input type="text" id="qatar2" placeholder="Ahmed or Sara?" style="width:100%;margin-top:.5rem">
            </div>
            <button class="btn maroon" onclick="checkQatar(2)">Check Answer</button>
            <div id="feedback2" style="margin-top:.5rem"></div>
          </div>
        </div>
      </div>

      <div id="qatar-intermediate" class="qatar-level-content" style="display:none">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;max-width:1200px;margin:0 auto">
          <div class="card" style="padding:1.5rem">
            <div class="qatar-icon">ğŸ’°</div>
            <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">Currency Exchange</h3>
            <div style="font-size:1.05rem;line-height:1.6;margin-bottom:1rem">
              Three exchange shops in Doha offer these rates for 1 USD:
              <ul style="margin-left:1.5rem;margin-top:.5rem">
                <li>Shop A: \(3\frac{2}{3}\) QAR</li>
                <li>Shop B: 3.64 QAR</li>
                <li>Shop C: \(\frac{73}{20}\) QAR</li>
              </ul>
              <strong>Which shop gives you the MOST QAR per dollar?</strong>
            </div>
            <div style="background:#f9fafb;padding:1rem;border-radius:8px;margin-bottom:1rem">
              <div style="font-weight:600;margin-bottom:.5rem">Strategy:</div>
              <div style="font-size:.9rem">
                Convert all to decimals OR use common denominator of 60
              </div>
              <input type="text" id="qatar3" placeholder="A, B, or C?" style="width:100%;margin-top:.5rem">
            </div>
            <button class="btn maroon" onclick="checkQatar(3)">Check Answer</button>
            <div id="feedback3" style="margin-top:.5rem"></div>
          </div>

          <div class="card" style="padding:1.5rem">
            <div class="qatar-icon">ğŸ—ï¸</div>
            <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">Lusail Construction</h3>
            <div style="font-size:1.05rem;line-height:1.6;margin-bottom:1rem">
              Three buildings are under construction:
              <ul style="margin-left:1.5rem;margin-top:.5rem">
                <li>Tower A: \(\frac{7}{8}\) complete</li>
                <li>Tower B: 0.82 complete</li>
                <li>Tower C: \(\frac{17}{20}\) complete</li>
              </ul>
              <strong>Order them from LEAST to MOST complete.</strong>
            </div>
            <input type="text" id="qatar4" placeholder="e.g., B < C < A" style="width:100%;margin-bottom:.5rem">
            <button class="btn maroon" onclick="checkQatar(4)">Check Answer</button>
            <div id="feedback4" style="margin-top:.5rem"></div>
          </div>
        </div>
      </div>

      <div id="qatar-advanced" class="qatar-level-content" style="display:none">
        <div style="max-width:1000px;margin:0 auto">
          <div class="card" style="padding:2rem">
            <div class="qatar-icon">ğŸ“Š</div>
            <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem;font-size:1.4rem">
              Qatar National Vision 2030 Analysis
            </h3>
            <div style="font-size:1.05rem;line-height:1.7;margin-bottom:1.5rem">
              Qatar's government has completed these percentages of various Vision 2030 pillars:
            </div>
            <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:1rem;margin-bottom:1.5rem">
              <div style="padding:1rem;background:#f0fdf4;border-radius:8px">
                <strong>Human Development:</strong> \(\frac{13}{15}\) complete
              </div>
              <div style="padding:1rem;background:#dbeafe;border-radius:8px">
                <strong>Social Development:</strong> 85% complete
              </div>
              <div style="padding:1rem;background:#fef3c7;border-radius:8px">
                <strong>Economic Development:</strong> \(0.88\) complete
              </div>
              <div style="padding:1rem;background:#fecaca;border-radius:8px">
                <strong>Environmental Development:</strong> \(\frac{21}{25}\) complete
              </div>
            </div>
            <div style="background:#fffbeb;padding:1.5rem;border-radius:8px;border:2px dashed var(--warning)">
              <div style="font-weight:700;margin-bottom:1rem">ğŸ¯ Multi-Step Challenge:</div>
              <ol style="margin-left:1.5rem;line-height:1.8">
                <li>Rank all four pillars from least to most complete</li>
                <li>Which two pillars are closest in completion?</li>
                <li>What is the average completion rate across all pillars? (Express as a simplified fraction)</li>
              </ol>
              <textarea id="qatar5" style="width:100%;margin-top:1rem;padding:1rem;border-radius:8px;border:2px solid #e5e7eb;min-height:100px" placeholder="Show your work and explain your reasoning..."></textarea>
            </div>
            <button class="btn maroon" style="margin-top:1rem" onclick="checkQatar(5)">Submit for Feedback</button>
            <div id="feedback5" style="margin-top:1rem"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- 6 â€¢ Interactive Practice Station -->
    <section class="slide" id="practiceStationSlide">
      <h2 style="font-size:2.5rem;font-weight:800;color:var(--maroon);margin-bottom:1rem;text-align:center">
        ğŸ® Practice Station: Build Your Skills
      </h2>

      <div style="max-width:1200px;margin:0 auto">
        <div style="text-align:center;margin-bottom:1.5rem">
          <div style="font-size:1.1rem;margin-bottom:.8rem">Choose Your Challenge:</div>
          <div style="display:flex;gap:1rem;justify-content:center;flex-wrap:wrap">
            <button class="btn station-btn active" data-station="simplify">ğŸ“ Simplify Fractions</button>
            <button class="btn station-btn" data-station="compare">âš–ï¸ Compare Pairs</button>
            <button class="btn station-btn" data-station="order">ğŸ“Š Order Sets</button>
            <button class="btn station-btn" data-station="mixed">ğŸ¯ Mixed Practice</button>
          </div>
        </div>

        <div id="practice-simplify" class="practice-content">
          <div class="card" style="padding:2rem">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem">
              <h3 style="font-weight:700;color:var(--maroon)">Simplify These Fractions</h3>
              <div>
                <button class="btn" onclick="newPracticeSet('simplify')">ğŸ”„ New Set</button>
                <button class="btn gold" onclick="practiceHint('simplify')">ğŸ’¡ Hint</button>
              </div>
            </div>
            <div id="simplifyProblems" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1rem">
            </div>
            <div style="margin-top:1.5rem;text-align:center">
              <button class="btn maroon" onclick="checkPractice('simplify')" style="font-size:1.1rem;padding:.8rem 2rem">
                âœ“ Check All Answers
              </button>
            </div>
            <div id="simplifyFeedback" style="margin-top:1rem;text-align:center;font-size:1.1rem;font-weight:700"></div>
          </div>
        </div>

        <div id="practice-compare" class="practice-content" style="display:none">
          <div class="card" style="padding:2rem">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem">
              <h3 style="font-weight:700;color:var(--maroon)">Compare These Pairs</h3>
              <div>
                <button class="btn" onclick="newPracticeSet('compare')">ğŸ”„ New Set</button>
                <button class="btn gold" onclick="practiceHint('compare')">ğŸ’¡ Hint</button>
              </div>
            </div>
            <div id="compareProblems" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1rem">
            </div>
            <div style="margin-top:1.5rem;text-align:center">
              <button class="btn maroon" onclick="checkPractice('compare')" style="font-size:1.1rem;padding:.8rem 2rem">
                âœ“ Check All Answers
              </button>
            </div>
            <div id="compareFeedback" style="margin-top:1rem;text-align:center;font-size:1.1rem;font-weight:700"></div>
          </div>
        </div>

        <div id="practice-order" class="practice-content" style="display:none">
          <div class="card" style="padding:2rem">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem">
              <h3 style="font-weight:700;color:var(--maroon)">Drag to Order (Least to Greatest)</h3>
              <button class="btn" onclick="newPracticeSet('order')">ğŸ”„ New Set</button>
            </div>
            <ul id="orderList" class="sortable" style="max-width:600px;margin:0 auto 1.5rem auto">
            </ul>
            <div style="text-align:center">
              <button class="btn maroon" onclick="checkPractice('order')" style="font-size:1.1rem;padding:.8rem 2rem">
                âœ“ Check Order
              </button>
            </div>
            <div id="orderFeedback" style="margin-top:1rem;text-align:center;font-size:1.1rem;font-weight:700"></div>
          </div>
        </div>

        <div id="practice-mixed" class="practice-content" style="display:none">
          <div class="card" style="padding:2rem;text-align:center">
            <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">Mixed Challenge</h3>
            <div style="font-size:1.1rem;margin-bottom:1.5rem">Coming soon - combines all skills!</div>
          </div>
        </div>
      </div>
    </section>

    <!-- 7 â€¢ Peer Teaching & Assessment -->
    <section class="slide" id="peerTeachSlide">
      <h2 style="font-size:2.5rem;font-weight:800;color:var(--maroon);margin-bottom:1rem;text-align:center">
        ğŸ‘¥ Teach What You've Learned
      </h2>

      <div style="max-width:1000px;margin:0 auto">
        <div class="success-msg" style="margin-bottom:1.5rem;text-align:center">
          <div style="font-size:1.2rem;font-weight:700;margin-bottom:.5rem">
            ğŸ“ The Best Way to Learn is to Teach!
          </div>
          <div>Work with a partner for this activity. Take turns being teacher and student.</div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.5rem">
          <div class="card" style="padding:1.5rem">
            <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">
              ğŸ‘¨â€ğŸ« When You're the Teacher
            </h3>
            <div style="background:#f0fdf4;padding:1rem;border-radius:8px;margin-bottom:1rem">
              <div style="font-weight:600;margin-bottom:.5rem">Your Task:</div>
              <ol style="margin-left:1.5rem;line-height:1.7">
                <li>Pick ONE method (common denominator, cross-multiply, or decimals)</li>
                <li>Create a practice problem about Qatar</li>
                <li>Teach your partner your method step-by-step</li>
                <li>Watch them solve YOUR problem</li>
              </ol>
            </div>
            <div class="hint">
              <strong>Teacher Checklist:</strong><br>
              â˜ Explained clearly<br>
              â˜ Used an example<br>
              â˜ Answered questions<br>
              â˜ Gave positive feedback
            </div>
          </div>

          <div class="card" style="padding:1.5rem">
            <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">
              ğŸ‘¨â€ğŸ“ When You're the Student
            </h3>
            <div style="background:#dbeafe;padding:1rem;border-radius:8px;margin-bottom:1rem">
              <div style="font-weight:600;margin-bottom:.5rem">Your Task:</div>
              <ol style="margin-left:1.5rem;line-height:1.7">
                <li>Listen carefully to your partner's explanation</li>
                <li>Ask questions if confused</li>
                <li>Try to solve their problem</li>
                <li>Explain YOUR thinking process</li>
              </ol>
            </div>
            <div class="hint">
              <strong>Student Checklist:</strong><br>
              â˜ Listened actively<br>
              â˜ Asked clarifying questions<br>
              â˜ Attempted the problem<br>
              â˜ Shared my thinking
            </div>
          </div>
        </div>

        <div class="card" style="padding:2rem;margin-top:1.5rem">
          <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem;text-align:center">
            ğŸ“ Create Your Teaching Problem
          </h3>
          <div style="display:grid;gap:1rem">
            <div>
              <label style="font-weight:600;display:block;margin-bottom:.5rem">Your Qatar Context:</label>
              <input type="text" id="peerContext" style="width:100%" placeholder="e.g., Shopping at Villagio Mall...">
            </div>
            <div>
              <label style="font-weight:600;display:block;margin-bottom:.5rem">Your Problem:</label>
              <textarea id="peerProblem" style="width:100%;min-height:80px" placeholder="Write your comparison or simplification problem..."></textarea>
            </div>
            <div>
              <label style="font-weight:600;display:block;margin-bottom:.5rem">Answer & Method:</label>
              <textarea id="peerAnswer" style="width:100%;min-height:60px" placeholder="Show how to solve it..."></textarea>
            </div>
          </div>
          <div style="text-align:center;margin-top:1rem">
            <button class="btn maroon" onclick="savePeerWork()">ğŸ’¾ Save My Teaching Problem</button>
            <button class="btn gold" onclick="downloadPeerWork()">â¬‡ï¸ Download for Portfolio</button>
          </div>
        </div>
      </div>
    </section>

    <!-- 8 â€¢ Exit Ticket & Reflection -->
    <section class="slide" id="exitSlide">
      <h2 style="font-size:2.5rem;font-weight:800;color:var(--maroon);margin-bottom:1.5rem;text-align:center">
        ğŸ¯ Exit Ticket: Show What You Know
      </h2>

      <div style="max-width:900px;margin:0 auto">
        <div class="card" style="padding:2rem;margin-bottom:1.5rem">
          <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1.5rem">
            Quick Assessment (3 questions)
          </h3>
          
          <div style="margin-bottom:2rem">
            <div style="font-weight:600;margin-bottom:.5rem">1. Simplify: \(\frac{48}{72}\)</div>
            <div style="display:flex;gap:1rem;align-items:center">
              <input type="text" id="exit1" style="width:150px" placeholder="numerator">
              <span>/</span>
              <input type="text" id="exit2" style="width:150px" placeholder="denominator">
            </div>
          </div>

          <div style="margin-bottom:2rem">
            <div style="font-weight:600;margin-bottom:.5rem">
              2. Compare: \(\frac{5}{6}\) ___ \(\frac{7}{9}\)
            </div>
            <select id="exit3" style="width:200px">
              <option value="">Choose...</option>
              <option value="<">&lt;</option>
              <option value=">">&gt;</option>
              <option value="=">=</option>
            </select>
          </div>

          <div style="margin-bottom:2rem">
            <div style="font-weight:600;margin-bottom:.8rem">
              3. Real-World: At Al Khor Beach, \(\frac{3}{5}\) of visitors are families and 0.58 are adults only. Which group is larger?
            </div>
            <div>
              <label style="margin-right:1.5rem">
                <input type="radio" name="exit4" value="families"> Families
              </label>
              <label>
                <input type="radio" name="exit4" value="adults"> Adults Only
              </label>
            </div>
          </div>

          <div style="text-align:center">
            <button class="btn maroon" style="font-size:1.1rem;padding:.8rem 2rem" onclick="checkExit()">
              âœ“ Submit Exit Ticket
            </button>
          </div>
          <div id="exitFeedback" style="margin-top:1.5rem;font-size:1.1rem;text-align:center"></div>
        </div>

        <div class="card" style="padding:2rem">
          <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">
            ğŸ¤” Self-Reflection
          </h3>
          <div style="display:grid;gap:1rem">
            <div>
              <div style="font-weight:600;margin-bottom:.5rem">
                What did you find EASIEST today?
              </div>
              <textarea id="reflect1" style="width:100%;min-height:60px"></textarea>
            </div>
            <div>
              <div style="font-weight:600;margin-bottom:.5rem">
                What was CHALLENGING and needs more practice?
              </div>
              <textarea id="reflect2" style="width:100%;min-height:60px"></textarea>
            </div>
            <div>
              <div style="font-weight:600;margin-bottom:.5rem">
                Where will you use rational numbers in YOUR life?
              </div>
              <textarea id="reflect3" style="width:100%;min-height:60px"></textarea>
            </div>
          </div>
          <div style="text-align:center;margin-top:1rem">
            <button class="btn gold" onclick="saveReflection()">ğŸ’¾ Save My Reflection</button>
          </div>
        </div>
      </div>
    </section>

    <!-- 9 â€¢ Extension & Next Steps -->
    <section class="slide" id="extensionSlide">
      <h2 style="font-size:2.5rem;font-weight:800;color:var(--maroon);margin-bottom:1.5rem;text-align:center">
        ğŸš€ Ready for More? Extension Activities
      </h2>

      <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:1.5rem;max-width:1200px;margin:0 auto">
        <div class="card" style="padding:1.5rem">
          <div style="font-size:2.5rem;margin-bottom:.5rem">ğŸ“±</div>
          <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">
            Create a Qatar Math Photo Story
          </h3>
          <div style="line-height:1.7;margin-bottom:1rem">
            Take photos around Qatar showing fractions in real life:
            <ul style="margin-left:1.5rem;margin-top:.5rem">
              <li>Pizza slices at a restaurant</li>
              <li>Parking lot sections</li>
              <li>Sale signs showing fractions off</li>
              <li>Sports scores or statistics</li>
            </ul>
          </div>
          <button class="btn maroon">Start Project</button>
        </div>

        <div class="card" style="padding:1.5rem">
          <div style="font-size:2.5rem;margin-bottom:.5rem">ğŸ²</div>
          <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">
            Fraction Card Game
          </h3>
          <div style="line-height:1.7;margin-bottom:1rem">
            Design a card game where players:
            <ul style="margin-left:1.5rem;margin-top:.5rem">
              <li>Draw fraction cards</li>
              <li>Compare to win rounds</li>
              <li>Simplify to earn bonus points</li>
              <li>First to 10 wins!</li>
            </ul>
          </div>
          <button class="btn maroon">Get Rules</button>
        </div>

        <div class="card" style="padding:1.5rem">
          <div style="font-size:2.5rem;margin-bottom:.5rem">ğŸ—ï¸</div>
          <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">
            Qatar 2030 Research Project
          </h3>
          <div style="line-height:1.7;margin-bottom:1rem">
            Research Qatar's development goals and create infographics showing progress as fractions and percentages.
          </div>
          <button class="btn maroon">Start Research</button>
        </div>

        <div class="card" style="padding:1.5rem">
          <div style="font-size:2.5rem;margin-bottom:.5rem">ğŸ¯</div>
          <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">
            Challenge Your Teacher!
          </h3>
          <div style="line-height:1.7;margin-bottom:1rem">
            Create the hardest fraction comparison problem you can, involving Qatar contexts. Challenge your teacher or classmates!
          </div>
          <button class="btn maroon">Create Challenge</button>
        </div>
      </div>

      <div class="qatar-context" style="margin-top:2rem;max-width:900px;margin-left:auto;margin-right:auto;text-align:center">
        <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem;font-size:1.3rem">
          ğŸ“ Next Lesson Preview
        </h3>
        <div style="font-size:1.1rem;line-height:1.7">
          <strong>Prime Factorization Toolkit</strong><br>
          Learn advanced techniques for finding GCF and LCM using factor trees and prime factorization - making fraction operations even easier!
        </div>
      </div>
    </section>

    <!-- 10 â€¢ Teacher Dashboard -->
    <section class="slide" id="dashboardSlide">
      <h2 style="font-size:2.5rem;font-weight:800;color:var(--maroon);margin-bottom:1rem;text-align:center">
        ğŸ‘¨â€ğŸ« Teacher Dashboard & Resources
      </h2>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;max-width:1200px;margin:0 auto">
        <div class="card" style="padding:1.5rem">
          <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">
            ğŸ“Š Lesson Structure
          </h3>
          <div style="line-height:1.8">
            <div><strong>â° Timing:</strong> 45-60 minutes</div>
            <div><strong>ğŸ“± Tech Needed:</strong> Device per student/pair</div>
            <div><strong>ğŸ‘¥ Grouping:</strong> Individual + pairs</div>
            <div><strong>ğŸ¯ Differentiation:</strong> 3 levels built-in</div>
          </div>
        </div>

        <div class="card" style="padding:1.5rem">
          <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">
            ğŸ¯ Learning Progressions
          </h3>
          <div style="font-size:.95rem;line-height:1.7">
            <strong>Beginner:</strong> Like denominators, simple fractions<br>
            <strong>Intermediate:</strong> Unlike denominators, mixed numbers<br>
            <strong>Advanced:</strong> Multi-step, negative rationals, applications
          </div>
        </div>

        <div class="card" style="padding:1.5rem">
          <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">
            ğŸ“‹ Formative Assessment Points
          </h3>
          <ol style="margin-left:1.5rem;line-height:1.7;font-size:.95rem">
            <li>Think-Pair-Share warmup</li>
            <li>Method selection justification</li>
            <li>Qatar problem solving</li>
            <li>Peer teaching quality</li>
            <li>Exit ticket (auto-graded)</li>
          </ol>
        </div>

        <div class="card" style="padding:1.5rem">
          <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">
            ğŸ’¡ Facilitation Tips
          </h3>
          <ul style="margin-left:1.5rem;line-height:1.7;font-size:.95rem">
            <li>Circulate during practice</li>
            <li>Highlight multiple strategies</li>
            <li>Connect to Qatar context</li>
            <li>Encourage peer discussion</li>
            <li>Celebrate all progress</li>
          </ul>
        </div>
      </div>

      <div style="text-align:center;margin-top:2rem">
        <button class="btn maroon" onclick="downloadTeacherGuide()">â¬‡ï¸ Download Full Teacher Guide (PDF)</button>
        <button class="btn gold" onclick="downloadStudentData()">ğŸ“Š Export Student Progress Data</button>
      </div>
    </section>

  </div>
</div>

<!-- Controls -->
<div id="controls" role="group" aria-label="Slideshow controls">
  <button id="prev" title="Previous (â†)">â€¹</button>
  <button id="fs" title="Toggle Fullscreen (F)">â¤¢</button>
  <div id="counter">1 / 11</div>
  <button id="next" title="Next (â†’)">â€º</button>
</div>
<div id="progress"></div>

<!-- Glossary Popover -->
<div id="glossaryPop" style="display:none;position:fixed;background:#fff;border:3px solid var(--gold);border-radius:12px;padding:1.5rem;max-width:400px;box-shadow:0 8px 24px rgba(0,0,0,.2);z-index:200">
  <button onclick="closeGlossary()" style="position:absolute;top:10px;right:10px;background:none;border:none;font-size:1.5rem;cursor:pointer;color:#999">Ã—</button>
  <div id="glossaryContent"></div>
</div>

<script>
// Boot KaTeX
window.addEventListener('DOMContentLoaded', () => {
  const renderMath = (root = document.body) => {
    if (!window.renderMathInElement) return;
    window.renderMathInElement(root, {
      delimiters: [
        { left: '$$', right: '$$', display: true },
        { left: '\\(', right: '\\)', display: false },
        { left: '\\[', right: '\\]', display: true }
      ],
      throwOnError: false
    });
  };

  const checkKaTeX = setInterval(() => {
    if (window.renderMathInElement) {
      clearInterval(checkKaTeX);
      renderMath();
      window.renderMath = renderMath;
    }
  }, 50);

  setTimeout(() => clearInterval(checkKaTeX), 5000);
});

/* ============ NAVIGATION & CORE ============ */
const slides = [...document.querySelectorAll('.slide')];
const GLOSSARY = {
  rat: '<strong>Rational Number (Ø¹Ø¯Ø¯ Ù†Ø³Ø¨ÙŠ)</strong><br>Any number that can be expressed as \\(\\frac{a}{b}\\) where a and b are integers and b â‰  0. Examples: \\(\\frac{3}{4}\\), 2.5, -7',
  eqv: '<strong>Equivalent Fractions (ÙƒØ³ÙˆØ± Ù…ØªØ³Ø§ÙˆÙŠØ©)</strong><br>Fractions that represent the same value. Example: \\(\\frac{2}{3} = \\frac{4}{6} = \\frac{8}{12}\\)',
  simp: '<strong>Simplest Form (Ø£Ø¨Ø³Ø· ØµÙˆØ±Ø©)</strong><br>A fraction where the numerator and denominator share no common factors except 1. Example: \\(\\frac{6}{8}\\) simplifies to \\(\\frac{3}{4}\\)',
  gcf: '<strong>Greatest Common Factor (GCF) â€” Ø§Ù„Ø¹Ø§Ù…Ù„ Ø§Ù„Ù…Ø´ØªØ±Ùƒ Ø§Ù„Ø£ÙƒØ¨Ø±</strong><br>The largest number that divides both the numerator and denominator',
  lcd: '<strong>Least Common Denominator (LCD) â€” Ø§Ù„Ù…Ù‚Ø§Ù… Ø§Ù„Ù…Ø´ØªØ±Ùƒ Ø§Ù„Ø£ØµØºØ±</strong><br>The smallest common multiple of two denominators',
  cross: '<strong>Cross-Multiplication</strong><br>Multiply numerator of first fraction by denominator of second, compare products',
  mixed: '<strong>Mixed Number (Ø¹Ø¯Ø¯ ÙƒØ³Ø±ÙŠ)</strong><br>A whole number combined with a proper fraction. Example: \\(3\\frac{1}{4}\\)',
  qar: '<strong>QAR (Qatari Riyal â€” Ø±ÙŠØ§Ù„ Ù‚Ø·Ø±ÙŠ)</strong><br>Official currency of Qatar. Symbol: QAR or Ø±.Ù‚'
};

let currentSlide = 0;
let studentData = {
  completed: [],
  streak: 0,
  answers: {}
};

function showSlide(n) {
  currentSlide = (n + slides.length) % slides.length;
  slides.forEach((s, i) => s.classList.toggle('active', i === currentSlide));
  document.getElementById('counter').textContent = `${currentSlide + 1} / ${slides.length}`;
  document.getElementById('progress').style.width = `${((currentSlide + 1) / slides.length) * 100}%`;
  if (window.renderMath) window.renderMath(slides[currentSlide]);
  updateTeacherNotes();
}

document.getElementById('prev').onclick = () => showSlide(currentSlide - 1);
document.getElementById('next').onclick = () => showSlide(currentSlide + 1);
document.getElementById('fs').onclick = () => {
  const el = document.getElementById('slides');
  if (!document.fullscreenElement) {
    (el.requestFullscreen || el.webkitRequestFullscreen).call(el);
  } else {
    (document.exitFullscreen || document.webkitExitFullscreen).call(document);
  }
};

document.addEventListener('keydown', e => {
  if (e.key === 'ArrowRight') showSlide(currentSlide + 1);
  if (e.key === 'ArrowLeft') showSlide(currentSlide - 1);
  if (e.key.toLowerCase() === 'f') document.getElementById('fs').click();
});

/* ============ GLOSSARY ============ */
document.addEventListener('click', e => {
  const chip = e.target.closest('.chip[data-key]');
  if (!chip) return;
  const key = chip.dataset.key;
  if (!GLOSSARY[key]) return;
  
  const pop = document.getElementById('glossaryPop');
  document.getElementById('glossaryContent').innerHTML = GLOSSARY[key];
  pop.style.display = 'block';
  const rect = chip.getBoundingClientRect();
  pop.style.left = Math.min(rect.left, window.innerWidth - pop.offsetWidth - 20) + 'px';
  pop.style.top = (rect.bottom + 10) + 'px';
  if (window.renderMath) window.renderMath(document.getElementById('glossaryContent'));
});

function closeGlossary() {
  document.getElementById('glossaryPop').style.display = 'none';
}

/* ============ TEACHER NOTES ============ */
const TEACHER_NOTES = {
  0: '<strong>Welcome Slide</strong><br>â€¢ Greet in Arabic<br>â€¢ Preview lesson flow<br>â€¢ Set expectations',
  1: '<strong>Goals & Success Criteria</strong><br>â€¢ Have students check off goals<br>â€¢ Review vocabulary together<br>â€¢ Explain mastery levels',
  2: '<strong>Think-Pair-Share</strong><br>â€¢ Give 2 min individual think time<br>â€¢ 3 min pair discussion<br>â€¢ Call on 3-4 groups to share<br>â€¢ Highlight different strategies',
  3: '<strong>Simplifying Methods</strong><br>â€¢ Let students choose their tab<br>â€¢ Visual learners see models<br>â€¢ Sequential learners get steps<br>â€¢ Kinesthetic try immediately',
  4: '<strong>Comparing Strategies</strong><br>â€¢ Students explore all 3 methods<br>â€¢ Discuss when each is best<br>â€¢ No single "right" method',
  5: '<strong>Qatar Real-World</strong><br>â€¢ Students self-select level<br>â€¢ Provide scaffolds as needed<br>â€¢ Connect to student experiences<br>â€¢ Allow calculator for complex',
  6: '<strong>Practice Station</strong><br>â€¢ Monitor progress<br>â€¢ Provide hints strategically<br>â€¢ Celebrate small wins<br>â€¢ Note struggling students',
  7: '<strong>Peer Teaching</strong><br>â€¢ Model good teaching first<br>â€¢ Circulate and listen<br>â€¢ Note student explanations<br>â€¢ This reveals understanding!',
  8: '<strong>Exit Ticket</strong><br>â€¢ Silent individual work<br>â€¢ Collect data for next lesson<br>â€¢ Review reflections tonight',
  9: '<strong>Extensions</strong><br>â€¢ For early finishers<br>â€¢ For homework options<br>â€¢ For gifted students',
  10: '<strong>Teacher Dashboard</strong><br>â€¢ Export data<br>â€¢ Review student progress<br>â€¢ Plan differentiation'
};

document.getElementById('teacherToggle').onclick = () => {
  const notes = document.getElementById('teacherNotes');
  notes.classList.toggle('show');
};

function updateTeacherNotes() {
  const notes = document.getElementById('teacherNotes');
  notes.innerHTML = TEACHER_NOTES[currentSlide] || '';
}

/* ============ MATH UTILITIES ============ */
function gcd(a, b) {
  a = Math.abs(Math.trunc(a));
  b = Math.abs(Math.trunc(b));
  while (b) [a, b] = [b, a % b];
  return a || 1;
}

function simplify(n, d) {
  const g = gcd(n, d);
  let sn = n / g, sd = d / g;
  if (sd < 0) { sn = -sn; sd = -sd; }
  return [sn, sd];
}

function randomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

function confetti() {
  for (let i = 0; i < 30; i++) {
    const el = document.createElement('div');
    el.className = 'confetti';
    el.textContent = ['ğŸ‰', 'â­', 'âœ¨', 'ğŸŒŸ'][i % 4];
    el.style.left = (Math.random() * window.innerWidth) + 'px';
    el.style.top = (Math.random() * window.innerHeight) + 'px';
    document.body.appendChild(el);
    
    const tx = (Math.random() - 0.5) * 300;
    const ty = (Math.random() - 0.5) * 300 - 150;
    el.animate([
      { transform: 'translate(0,0) rotate(0deg) scale(1)', opacity: 1 },
      { transform: `translate(${tx}px,${ty}px) rotate(${Math.random()*720}deg) scale(0)`, opacity: 0 }
    ], {
      duration: 1500,
      easing: 'cubic-bezier(.2,.8,.2,1)'
    }).onfinish = () => el.remove();
  }
}

function updateProgress() {
  const total = 20; // Total activities
  const completed = studentData.completed.length;
  const percent = Math.floor((completed / total) * 100);
  
  document.getElementById('masterBar').style.width = percent + '%';
  document.getElementById('masterPercent').textContent = percent;
  document.getElementById('completeCount').textContent = completed;
  document.getElementById('streakDisplay').textContent = studentData.streak;
}

/* ============ WARM-UP ============ */
function showAnswer() {
  const answer = document.getElementById('warmupAnswer');
  answer.style.display = 'block';
  answer.innerHTML = `
    <div class="success-msg">
      <h4 style="font-weight:700;margin-bottom:1rem">âœ… Correct Answer: Section B (\\(\\frac{7}{10}\\))</h4>
      <div style="text-align:left">
        <strong>Strategy 1 - Common Denominator:</strong><br>
        \\(\\frac{3}{4} = \\frac{15}{20}\\), \\(\\frac{7}{10} = \\frac{14}{20}\\), \\(0.72 = \\frac{72}{100} = \\frac{36}{50}\\) â†’ Compare<br><br>
        
        <strong>Strategy 2 - Convert to Decimals:</strong><br>
        \\(\\frac{3}{4} = 0.75\\), \\(\\frac{7}{10} = 0.70\\), \\(0.72\\) â†’ Section A is fullest!<br><br>
        
        <strong>Wait - Different Answer?</strong> Let's be precise!<br>
        \\(\\frac{3}{4} = 0.75\\) vs \\(0.72\\) â†’ Section A is actually fullest!
      </div>
    </div>
  `;
  if (window.renderMath) window.renderMath(answer);
}

/* ============ DIFFERENTIATION TABS ============ */
document.addEventListener('click', e => {
  const tab = e.target.closest('.diff-tab');
  if (!tab) return;
  
  const diff = tab.dataset.diff;
  document.querySelectorAll('.diff-tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.diff-content').forEach(c => c.style.display = 'none');
  
  tab.classList.add('active');
  document.getElementById('diff-' + diff).style.display = 'block';
  
  if (diff === 'practice' && !document.getElementById('simplifyPractice').innerHTML) {
    loadSimplifyPractice();
  }
});

function loadSimplifyPractice() {
  const container = document.getElementById('simplifyPractice');
  container.innerHTML = `
    <div style="margin-bottom:1rem">
      <strong>Practice Problem:</strong> Simplify \\(\\frac{24}{36}\\)
    </div>
    <div style="display:flex;gap:1rem;align-items:center;margin-bottom:1rem">
      <span>\\(\\frac{24}{36} = \\frac{\\)</span>
      <input type="number" id="practiceNum" style="width:80px">
      <span>}{</span>
      <input type="number" id="practiceDen" style="width:80px">
      <span>}\\)</span>
      <button class="btn maroon" onclick="checkSimplifyPractice()">Check</button>
    </div>
    <div id="practiceFeedback"></div>
    <button class="btn" onclick="loadSimplifyPractice()" style="margin-top:1rem">New Problem</button>
  `;
  if (window.renderMath) window.renderMath(container);
}

function checkSimplifyPractice() {
  const n = parseInt(document.getElementById('practiceNum').value);
  const d = parseInt(document.getElementById('practiceDen').value);
  const [correctN, correctD] = simplify(24, 36);
  const [userN, userD] = simplify(n, d);
  
  const fb = document.getElementById('practiceFeedback');
  if (userN === correctN && userD === correctD) {
    fb.innerHTML = '<div class="success-msg">âœ… Perfect! You got \\(\\frac{2}{3}\\)</div>';
    confetti();
    studentData.streak++;
    if (!studentData.completed.includes('simplify-practice')) {
      studentData.completed.push('simplify-practice');
      updateProgress();
    }
  } else {
    fb.innerHTML = '<div class="error-msg">Not quite. Try finding the GCF of 24 and 36 first.</div>';
    studentData.streak = 0;
  }
  if (window.renderMath) window.renderMath(fb);
  updateProgress();
}

/* ============ COMPARING METHODS ============ */
function showMethod(method) {
  const detail = document.getElementById('methodDetail');
  detail.style.display = 'block';
  
  const examples = {
    lcd: `
      <div class="card" style="padding:2rem">
        <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">Method 1: Common Denominator</h3>
        <div style="font-size:1.1rem;line-height:2">
          <strong>Example:</strong> Compare \\(\\frac{3}{4}\\) and \\(\\frac{5}{6}\\)<br><br>
          <strong>Step 1:</strong> Find LCD of 4 and 6 â†’ 12<br>
          <strong>Step 2:</strong> Convert: \\(\\frac{3}{4} = \\frac{9}{12}\\) and \\(\\frac{5}{6} = \\frac{10}{12}\\)<br>
          <strong>Step 3:</strong> Compare numerators: 9 < 10<br>
          <strong>Answer:</strong> \\(\\frac{3}{4} < \\frac{5}{6}\\)
        </div>
        <div class="hint" style="margin-top:1.5rem">
          <strong>Best when:</strong> Denominators are small or have obvious LCD
        </div>
      </div>
    `,
    cross: `
      <div class="card" style="padding:2rem">
        <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">Method 2: Cross-Multiplication</h3>
        <div style="font-size:1.1rem;line-height:2">
          <strong>Example:</strong> Compare \\(\\frac{3}{4}\\) and \\(\\frac{5}{6}\\)<br><br>
          <strong>Step 1:</strong> Multiply 3 Ã— 6 = 18<br>
          <strong>Step 2:</strong> Multiply 4 Ã— 5 = 20<br>
          <strong>Step 3:</strong> Compare: 18 < 20<br>
          <strong>Answer:</strong> \\(\\frac{3}{4} < \\frac{5}{6}\\)
        </div>
        <div class="hint" style="margin-top:1.5rem">
          <strong>Best when:</strong> Quick comparison needed, denominators are positive
        </div>
      </div>
    `,
    decimal: `
      <div class="card" style="padding:2rem">
        <h3 style="font-weight:700;color:var(--maroon);margin-bottom:1rem">Method 3: Convert to Decimals</h3>
        <div style="font-size:1.1rem;line-height:2">
          <strong>Example:</strong> Compare \\(\\frac{3}{4}\\) and \\(\\frac{5}{6}\\)<br><br>
          <strong>Step 1:</strong> \\(\\frac{3}{4} = 3 \\div 4 = 0.75\\)<br>
          <strong>Step 2:</strong> \\(\\frac{5}{6} = 5 \\div 6 = 0.833...\\)<br>
          <strong>Step 3:</strong> Compare: 0.75 < 0.833<br>
          <strong>Answer:</strong> \\(\\frac{3}{4} < \\frac{5}{6}\\)
        </div>
        <div class="hint" style="margin-top:1.5rem">
          <strong>Best when:</strong> Calculator available or mental division is easy
        </div>
      </div>
    `
  };
  
  detail.innerHTML = examples[method];
  if (window.renderMath) window.renderMath(detail);
  detail.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

/* ============ QATAR PROBLEMS ============ */
document.addEventListener('click', e => {
  const btn = e.target.closest('.level-btn');
  if (!btn) return;
  
  const level = btn.dataset.level;
  document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.qatar-level-content').forEach(c => c.style.display = 'none');
  
  btn.classList.add('active');
  document.getElementById('qatar-' + level).style.display = 'block';
});

function checkQatar(n) {
  const answers = {
    1: 'clothes',
    2: 'sara',
    3: 'c',
    4: 'b<c<a',
    5: '' // Open-ended
  };
  
  const input = document.getElementById('qatar' + n);
  const feedback = document.getElementById('feedback' + n);
  const userAnswer = input.value.toLowerCase().trim();
  
  if (n === 5) {
    feedback.innerHTML = '<div class="success-msg">âœ… Great thinking! Teacher will review your response.</div>';
    return;
  }
  
  const correct = answers[n];
  if (userAnswer === correct || userAnswer.replace(/\s/g, '') === correct) {
    feedback.innerHTML = '<div class="success-msg">âœ… Excellent! You got it!</div>';
    input.classList.add('correct');
    input.classList.remove('incorrect');
    confetti();
    if (!studentData.completed.includes('qatar' + n)) {
      studentData.completed.push('qatar' + n);
      studentData.streak++;
      updateProgress();
    }
  } else {
    feedback.innerHTML = '<div class="error-msg">âŒ Not quite. Check your work and try again!</div>';
    input.classList.add('incorrect');
    input.classList.remove('correct');
    studentData.streak = 0;
    updateProgress();
  }
}

/* ============ PRACTICE STATION ============ */
const practiceData = {
  simplify: [],
  compare: [],
  order: []
};

document.addEventListener('click', e => {
  const btn = e.target.closest('.station-btn');
  if (!btn) return;
  
  const station = btn.dataset.station;
  document.querySelectorAll('.station-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.practice-content').forEach(c => c.style.display = 'none');
  
  btn.classList.add('active');
  document.getElementById('practice-' + station).style.display = 'block';
  
  if (practiceData[station].length === 0) {
    newPracticeSet(station);
  }
});

function newPracticeSet(type) {
  if (type === 'simplify') {
    practiceData.simplify = [];
    for (let i = 0; i < 6; i++) {
      let n = randomInt(6, 48);
      let d = randomInt(6, 60);
      if (Math.random() < 0.5) {
        const k = [2, 3, 4, 5, 6][randomInt(0, 4)];
        n *= k;
        d *= k;
      }
      practiceData.simplify.push([n, d]);
    }
    renderSimplifyProblems();
  } else if (type === 'compare') {
    practiceData.compare = [];
    for (let i = 0; i < 6; i++) {
      const d1 = [4, 5, 6, 7, 8, 9, 10, 12][randomInt(0, 7)];
      const d2 = [4, 5, 6, 7, 8, 9, 10, 12][randomInt(0, 7)];
      const n1 = randomInt(1, d1 * 2 - 1);
      const n2 = randomInt(1, d2 * 2 - 1);
      practiceData.compare.push([n1, d1, n2, d2]);
    }
    renderCompareProblems();
  } else if (type === 'order') {
    practiceData.order = [];
    for (let i = 0; i < 6; i++) {
      const d = [4, 5, 6, 8, 10, 12][randomInt(0, 5)];
      const n = randomInt(1, d * 2);
      practiceData.order.push([n, d]);
    }
    renderOrderProblems();
  }
}

function renderSimplifyProblems() {
  const container = document.getElementById('simplifyProblems');
  container.innerHTML = '';
  
  practiceData.simplify.forEach((frac, i) => {
    const [n, d] = frac;
    const div = document.createElement('div');
    div.className = 'card';
    div.style.padding = '1rem';
    div.innerHTML = `
      <div style="font-weight:700;margin-bottom:.5rem">Problem ${i + 1}</div>
      <div style="font-size:1.2rem;margin-bottom:.5rem">\\(\\frac{${n}}{${d}}\\) =</div>
      <div style="display:flex;gap:.5rem;align-items:center">
        <input type="number" class="simp-n" data-idx="${i}" style="width:70px">
        <span>/</span>
        <input type="number" class="simp-d" data-idx="${i}" style="width:70px">
      </div>
    `;
    container.appendChild(div);
  });
  
  if (window.renderMath) window.renderMath(container);
}

function renderCompareProblems() {
  const container = document.getElementById('compareProblems');
  container.innerHTML = '';
  
  practiceData.compare.forEach((frac, i) => {
    const [n1, d1, n2, d2] = frac;
    const div = document.createElement('div');
    div.className = 'card';
    div.style.padding = '1rem';
    div.innerHTML = `
      <div style="font-weight:700;margin-bottom:.5rem">Problem ${i + 1}</div>
      <div style="font-size:1.2rem;display:flex;gap:.5rem;align-items:center">
        <span>\\(\\frac{${n1}}{${d1}}\\)</span>
        <select class="cmp-sign" data-idx="${i}" style="width:60px">
          <option value="">?</option>
          <option value="<">&lt;</option>
          <option value=">">&gt;</option>
          <option value="=">=</option>
        </select>
        <span>\\(\\frac{${n2}}{${d2}}\\)</span>
      </div>
    `;
    container.appendChild(div);
  });
  
  if (window.renderMath) window.renderMath(container);
}

function renderOrderProblems() {
  const ul = document.getElementById('orderList');
  ul.innerHTML = '';
  
  // Shuffle
  const shuffled = [...practiceData.order].sort(() => Math.random() - 0.5);
  
  shuffled.forEach((frac, i) => {
    const [n, d] = frac;
    const li = document.createElement('li');
    li.draggable = true;
    li.dataset.n = n;
    li.dataset.d = d;
    li.innerHTML = `<span class="handle">â†•</span> \\(\\frac{${n}}{${d}}\\)`;
    ul.appendChild(li);
  });
  
  makeSortable(ul);
  if (window.renderMath) window.renderMath(ul);
}

function makeSortable(ul) {
  let dragging = null;
  
  ul.querySelectorAll('li').forEach(li => {
    li.addEventListener('dragstart', () => {
      dragging = li;
      li.classList.add('dragging');
    });
    li.addEventListener('dragend', () => {
      dragging = null;
      li.classList.remove('dragging');
    });
  });
  
  ul.addEventListener('dragover', e => {
    e.preventDefault();
    const after = [...ul.querySelectorAll('li:not(.dragging)')].find(li => {
      const box = li.getBoundingClientRect();
      return e.clientY < box.top + box.height / 2;
    });
    if (after) ul.insertBefore(dragging, after);
    else ul.appendChild(dragging);
  });
}

function checkPractice(type) {
  if (type === 'simplify') {
    let correct = 0;
    practiceData.simplify.forEach((frac, i) => {
      const [n, d] = frac;
      const [correctN, correctD] = simplify(n, d);
      const userN = parseInt(document.querySelector(`.simp-n[data-idx="${i}"]`).value);
      const userD = parseInt(document.querySelector(`.simp-d[data-idx="${i}"]`).value);
      const [simpN, simpD] = simplify(userN, userD);
      
      const nInput = document.querySelector(`.simp-n[data-idx="${i}"]`);
      const dInput = document.querySelector(`.simp-d[data-idx="${i}"]`);
      
      if (simpN === correctN && simpD === correctD) {
        nInput.classList.add('correct');
        dInput.classList.add('correct');
        nInput.classList.remove('incorrect');
        dInput.classList.remove('incorrect');
        correct++;
      } else {
        nInput.classList.add('incorrect');
        dInput.classList.add('incorrect');
        nInput.classList.remove('correct');
        dInput.classList.remove('correct');
      }
    });
    
    const feedback = document.getElementById('simplifyFeedback');
    if (correct === practiceData.simplify.length) {
      feedback.innerHTML = '<span style="color:var(--success)">âœ… Perfect! All correct!</span>';
      confetti();
      if (!studentData.completed.includes('practice-simplify')) {
        studentData.completed.push('practice-simplify');
        studentData.streak++;
        updateProgress();
      }
    } else {
      feedback.innerHTML = `<span style="color:var(--error)">Score: ${correct}/${practiceData.simplify.length} - Keep trying!</span>`;
    }
  } else if (type === 'compare') {
    let correct = 0;
    practiceData.compare.forEach((frac, i) => {
      const [n1, d1, n2, d2] = frac;
      const sel = document.querySelector(`.cmp-sign[data-idx="${i}"]`);
      const userSign = sel.value;
      
      const cross1 = n1 * d2;
      const cross2 = d1 * n2;
      const correctSign = cross1 < cross2 ? '<' : cross1 > cross2 ? '>' : '=';
      
      if (userSign === correctSign) {
        sel.classList.add('correct');
        sel.classList.remove('incorrect');
        correct++;
      } else {
        sel.classList.add('incorrect');
        sel.classList.remove('correct');
      }
    });
    
    const feedback = document.getElementById('compareFeedback');
    if (correct === practiceData.compare.length) {
      feedback.innerHTML = '<span style="color:var(--success)">âœ… Excellent! All comparisons correct!</span>';
      confetti();
      if (!studentData.completed.includes('practice-compare')) {
        studentData.completed.push('practice-compare');
        studentData.streak++;
        updateProgress();
      }
    } else {
      feedback.innerHTML = `<span style="color:var(--error)">Score: ${correct}/${practiceData.compare.length}</span>`;
    }
  } else if (type === 'order') {
    const lis = [...document.getElementById('orderList').children];
    const userOrder = lis.map(li => [parseInt(li.dataset.n), parseInt(li.dataset.d)]);
    
    let isCorrect = true;
    for (let i = 1; i < userOrder.length; i++) {
      const [n1, d1] = userOrder[i - 1];
      const [n2, d2] = userOrder[i];
      if (n1 * d2 > n2 * d1) {
        isCorrect = false;
        break;
      }
    }
    
    const feedback = document.getElementById('orderFeedback');
    if (isCorrect) {
      feedback.innerHTML = '<span style="color:var(--success)">âœ… Perfect order!</span>';
      confetti();
      if (!studentData.completed.includes('practice-order')) {
        studentData.completed.push('practice-order');
        studentData.streak++;
        updateProgress();
      }
    } else {
      feedback.innerHTML = '<span style="color:var(--error)">âŒ Not quite right. Try again!</span>';
    }
  }
}

function practiceHint(type) {
  const hints = {
    simplify: 'Find the GCF of the numerator and denominator, then divide both by it!',
    compare: 'Try cross-multiplying: multiply each numerator by the opposite denominator!',
    order: 'Convert all to the same denominator or to decimals to compare easily!'
  };
  alert('ğŸ’¡ Hint: ' + hints[type]);
}

/* ============ PEER TEACHING ============ */
function savePeerWork() {
  const context = document.getElementById('peerContext').value;
  const problem = document.getElementById('peerProblem').value;
  const answer = document.getElementById('peerAnswer').value;
  
  if (!context || !problem || !answer) {
    alert('Please fill in all fields!');
    return;
  }
  
  studentData.answers.peerTeaching = { context, problem, answer };
  alert('âœ… Your teaching problem has been saved!');
  if (!studentData.completed.includes('peer-teaching')) {
    studentData.completed.push('peer-teaching');
    updateProgress();
  }
}

function downloadPeerWork() {
  const data = studentData.answers.peerTeaching;
  if (!data) {
    alert('Please save your work first!');
    return;
  }
  
  const text = `MY TEACHING PROBLEM\n\nContext: ${data.context}\n\nProblem:\n${data.problem}\n\nAnswer & Method:\n${data.answer}`;
  const blob = new Blob([text], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'my_math_teaching_problem.txt';
  a.click();
  URL.revokeObjectURL(url);
}

/* ============ EXIT TICKET ============ */
function checkExit() {
  const n = parseInt(document.getElementById('exit1').value);
  const d = parseInt(document.getElementById('exit2').value);
  const sign = document.getElementById('exit3').value;
  const q3 = document.querySelector('input[name="exit4"]:checked')?.value;
  
  let score = 0;
  const [correctN, correctD] = simplify(48, 72);
  const [userN, userD] = simplify(n, d);
  
  if (userN === correctN && userD === correctD) score++;
  
  // 5/6 vs 7/9: 5*9=45, 6*7=42, so 5/6 > 7/9
  if (sign === '>') score++;
  
  // 3/5 = 0.6 vs 0.58, families are larger
  if (q3 === 'families') score++;
  
  const feedback = document.getElementById('exitFeedback');
  if (score === 3) {
    feedback.innerHTML = '<div class="success-msg">âœ… Perfect! You\'ve mastered the content! ğŸ‰</div>';
    confetti();
    if (!studentData.completed.includes('exit-ticket')) {
      studentData.completed.push('exit-ticket');
      updateProgress();
    }
  } else {
    feedback.innerHTML = `<div class="error-msg">Score: ${score}/3 - Review and try again!</div>`;
  }
}

function saveReflection() {
  const r1 = document.getElementById('reflect1').value;
  const r2 = document.getElementById('reflect2').value;
  const r3 = document.getElementById('reflect3').value;
  
  if (!r1 || !r2 || !r3) {
    alert('Please complete all reflection questions!');
    return;
  }
  
  studentData.answers.reflection = { easiest: r1, challenging: r2, realLife: r3 };
  alert('âœ… Your reflection has been saved!');
  if (!studentData.completed.includes('reflection')) {
    studentData.completed.push('reflection');
    updateProgress();
  }
}

/* ============ DATA EXPORT ============ */
function downloadTeacherGuide() {
  alert('Teacher Guide PDF would be downloaded here (requires backend)');
}

function downloadStudentData() {
  const json = JSON.stringify(studentData, null, 2);
  const blob = new Blob([json], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'student_progress_data.json';
  a.click();
  URL.revokeObjectURL(url);
}

/* ============ INIT ============ */
showSlide(0);
updateProgress();
newPracticeSet('simplify');
</script>

</body>
</html>
